'''
This script plots two optimization results, selected because they were available for the same sigma
between trad and doubled, and were optimizing the same gate (in this case pi/2), and the results were
moderately smooth, clear, and centered.

The large data arrays were copied in after running `extract_pi_opt.m` (which reads the MATLAB figures)
which is also saved in RP-23/SMC-A/Analysis.

Conditions: 10 ns squared/final sigma, half-pi optimization.

'''

import matplotlib as mpl
import matplotlib.pyplot as plt
import numpy as np
import mplcursors
import argparse
import os

parser = argparse.ArgumentParser()
parser.add_argument('-p', '--pub', help="Publication version.", action='store_true')
parser.add_argument('-s', '--save', help="Save figure to PDF.", action='store_true')
args = parser.parse_args()

## ------- Copy data from MATLAB ----------------

doub_x = np.array([0.95, 0.955, 0.96, 0.965, 0.97, 0.975, 0.98, 0.985, 0.99, 0.995, 1, 1.005, 1.01, 1.015, 1.02, 1.025, 1.03, 1.035, 1.04, 1.045, 1.05])
doub_y = np.array([0.022947, 0.023269, 0.023625, 0.023198, 0.02316, 0.024424, 0.023576, 0.019567, 0.017406, 0.020178, 0.023391, 0.02409, 0.022535, 0.02265, 0.024037, 0.023524, 0.022871, 0.023932, 0.024096, 0.022534, 0.023053])
trad_x = np.array([0.97, 0.97533, 0.98067, 0.986, 0.99133, 0.99667, 1.002, 1.0073, 1.0127, 1.018, 1.0233, 1.0287, 1.034, 1.0393, 1.0447, 1.05])
trad_y = np.array([-0.0098571, -0.010369, -0.010564, -0.0097109, -0.0094195, -0.013955, -0.018266, -0.017464, -0.016905, -0.010949, -0.0099976, -0.0089594, -0.0099271, -0.0098027, -0.0092343, -0.010448])


doub_x_fit = np.array([0.95, 0.951, 0.952, 0.953, 0.954, 0.955, 0.956, 0.957, 0.958, 0.959, 0.96, 0.961, 0.962, 0.963, 0.964, 0.965, 0.966, 0.967, 0.968, 0.969, 0.97, 0.971, 0.972, 0.973, 0.974, 0.975, 0.976, 0.977, 0.978, 0.979, 0.98, 0.981, 0.982, 0.983, 0.984, 0.985, 0.986, 0.987, 0.988, 0.989, 0.99, 0.991, 0.992, 0.993, 0.994, 0.995, 0.996, 0.997, 0.998, 0.999, 1, 1.001, 1.002, 1.003, 1.004, 1.005, 1.006, 1.007, 1.008, 1.009, 1.01, 1.011, 1.012, 1.013, 1.014, 1.015, 1.016, 1.017, 1.018, 1.019, 1.02, 1.021, 1.022, 1.023, 1.024, 1.025, 1.026, 1.027, 1.028, 1.029, 1.03, 1.031, 1.032, 1.033, 1.034, 1.035, 1.036, 1.037, 1.038, 1.039, 1.04, 1.041, 1.042, 1.043, 1.044, 1.045, 1.046, 1.047, 1.048, 1.049, 1.05])
doub_y_fit = np.array([0.023173, 0.023273, 0.023354, 0.023419, 0.023467, 0.023501, 0.023521, 0.023528, 0.023523, 0.023506, 0.02348, 0.023445, 0.023401, 0.02335, 0.023292, 0.023228, 0.023159, 0.023085, 0.023008, 0.022927, 0.022845, 0.02276, 0.022675, 0.022589, 0.022503, 0.022417, 0.022333, 0.02225, 0.022169, 0.022091, 0.022016, 0.021944, 0.021876, 0.021811, 0.021751, 0.021696, 0.021646, 0.0216, 0.02156, 0.021526, 0.021497, 0.021475, 0.021458, 0.021448, 0.021443, 0.021445, 0.021453, 0.021468, 0.021488, 0.021515, 0.021548, 0.021587, 0.021632, 0.021682, 0.021738, 0.0218, 0.021867, 0.021938, 0.022015, 0.022095, 0.02218, 0.022268, 0.02236, 0.022455, 0.022552, 0.022651, 0.022752, 0.022854, 0.022956, 0.023059, 0.023161, 0.023262, 0.023361, 0.023458, 0.023552, 0.023642, 0.023728, 0.023809, 0.023884, 0.023952, 0.024013, 0.024065, 0.024108, 0.024141, 0.024163, 0.024173, 0.024171, 0.024154, 0.024123, 0.024076, 0.024011, 0.023929, 0.023828, 0.023706, 0.023563, 0.023398, 0.023208, 0.022994, 0.022753, 0.022485, 0.022188])
trad_x_fit = np.array([0.97, 0.97008, 0.97016, 0.97024, 0.97032, 0.9704, 0.97048, 0.97056, 0.97064, 0.97072, 0.9708, 0.97088, 0.97096, 0.97104, 0.97112, 0.9712, 0.97128, 0.97136, 0.97144, 0.97152, 0.9716, 0.97168, 0.97176, 0.97184, 0.97192, 0.972, 0.97208, 0.97216, 0.97224, 0.97232, 0.9724, 0.97248, 0.97256, 0.97264, 0.97272, 0.9728, 0.97288, 0.97296, 0.97304, 0.97312, 0.9732, 0.97328, 0.97336, 0.97344, 0.97352, 0.9736, 0.97368, 0.97376, 0.97384, 0.97392, 0.974, 0.97408, 0.97416, 0.97424, 0.97432, 0.9744, 0.97448, 0.97456, 0.97464, 0.97472, 0.9748, 0.97488, 0.97496, 0.97504, 0.97512, 0.9752, 0.97528, 0.97533, 0.97536, 0.97544, 0.97552, 0.9756, 0.97568, 0.97576, 0.97584, 0.97592, 0.976, 0.97608, 0.97616, 0.97624, 0.97632, 0.9764, 0.97648, 0.97656, 0.97664, 0.97672, 0.9768, 0.97688, 0.97696, 0.97704, 0.97712, 0.9772, 0.97728, 0.97736, 0.97744, 0.97752, 0.9776, 0.97768, 0.97776, 0.97784, 0.97792, 0.978, 0.97808, 0.97816, 0.97824, 0.97832, 0.9784, 0.97848, 0.97856, 0.97864, 0.97872, 0.9788, 0.97888, 0.97896, 0.97904, 0.97912, 0.9792, 0.97928, 0.97936, 0.97944, 0.97952, 0.9796, 0.97968, 0.97976, 0.97984, 0.97992, 0.98, 0.98008, 0.98016, 0.98024, 0.98032, 0.9804, 0.98048, 0.98056, 0.98064, 0.98067, 0.98072, 0.9808, 0.98088, 0.98096, 0.98104, 0.98112, 0.9812, 0.98128, 0.98136, 0.98144, 0.98152, 0.9816, 0.98168, 0.98176, 0.98184, 0.98192, 0.982, 0.98208, 0.98216, 0.98224, 0.98232, 0.9824, 0.98248, 0.98256, 0.98264, 0.98272, 0.9828, 0.98288, 0.98296, 0.98304, 0.98312, 0.9832, 0.98328, 0.98336, 0.98344, 0.98352, 0.9836, 0.98368, 0.98376, 0.98384, 0.98392, 0.984, 0.98408, 0.98416, 0.98424, 0.98432, 0.9844, 0.98448, 0.98456, 0.98464, 0.98472, 0.9848, 0.98488, 0.98496, 0.98504, 0.98512, 0.9852, 0.98528, 0.98536, 0.98544, 0.98552, 0.9856, 0.98568, 0.98576, 0.98584, 0.98592, 0.986, 0.98608, 0.98616, 0.98624, 0.98632, 0.9864, 0.98648, 0.98656, 0.98664, 0.98672, 0.9868, 0.98688, 0.98696, 0.98704, 0.98712, 0.9872, 0.98728, 0.98736, 0.98744, 0.98752, 0.9876, 0.98768, 0.98776, 0.98784, 0.98792, 0.988, 0.98808, 0.98816, 0.98824, 0.98832, 0.9884, 0.98848, 0.98856, 0.98864, 0.98872, 0.9888, 0.98888, 0.98896, 0.98904, 0.98912, 0.9892, 0.98928, 0.98936, 0.98944, 0.98952, 0.9896, 0.98968, 0.98976, 0.98984, 0.98992, 0.99, 0.99008, 0.99016, 0.99024, 0.99032, 0.9904, 0.99048, 0.99056, 0.99064, 0.99072, 0.9908, 0.99088, 0.99096, 0.99104, 0.99112, 0.9912, 0.99128, 0.99133, 0.99136, 0.99144, 0.99152, 0.9916, 0.99168, 0.99176, 0.99184, 0.99192, 0.992, 0.99208, 0.99216, 0.99224, 0.99232, 0.9924, 0.99248, 0.99256, 0.99264, 0.99272, 0.9928, 0.99288, 0.99296, 0.99304, 0.99312, 0.9932, 0.99328, 0.99336, 0.99344, 0.99352, 0.9936, 0.99368, 0.99376, 0.99384, 0.99392, 0.994, 0.99408, 0.99416, 0.99424, 0.99432, 0.9944, 0.99448, 0.99456, 0.99464, 0.99472, 0.9948, 0.99488, 0.99496, 0.99504, 0.99512, 0.9952, 0.99528, 0.99536, 0.99544, 0.99552, 0.9956, 0.99568, 0.99576, 0.99584, 0.99592, 0.996, 0.99608, 0.99616, 0.99624, 0.99632, 0.9964, 0.99648, 0.99656, 0.99664, 0.99667, 0.99672, 0.9968, 0.99688, 0.99696, 0.99704, 0.99712, 0.9972, 0.99728, 0.99736, 0.99744, 0.99752, 0.9976, 0.99768, 0.99776, 0.99784, 0.99792, 0.998, 0.99808, 0.99816, 0.99824, 0.99832, 0.9984, 0.99848, 0.99856, 0.99864, 0.99872, 0.9988, 0.99888, 0.99896, 0.99904, 0.99912, 0.9992, 0.99928, 0.99936, 0.99944, 0.99952, 0.9996, 0.99968, 0.99976, 0.99984, 0.99992, 1, 1.0001, 1.0002, 1.0002, 1.0003, 1.0004, 1.0005, 1.0006, 1.0006, 1.0007, 1.0008, 1.0009, 1.001, 1.001, 1.0011, 1.0012, 1.0013, 1.0014, 1.0014, 1.0015, 1.0016, 1.0017, 1.0018, 1.0018, 1.0019, 1.002, 1.0021, 1.0022, 1.0022, 1.0023, 1.0024, 1.0025, 1.0026, 1.0026, 1.0027, 1.0028, 1.0029, 1.003, 1.003, 1.0031, 1.0032, 1.0033, 1.0034, 1.0034, 1.0035, 1.0036, 1.0037, 1.0038, 1.0038, 1.0039, 1.004, 1.0041, 1.0042, 1.0042, 1.0043, 1.0044, 1.0045, 1.0046, 1.0046, 1.0047, 1.0048, 1.0049, 1.005, 1.005, 1.0051, 1.0052, 1.0053, 1.0054, 1.0054, 1.0055, 1.0056, 1.0057, 1.0058, 1.0058, 1.0059, 1.006, 1.0061, 1.0062, 1.0062, 1.0063, 1.0064, 1.0065, 1.0066, 1.0066, 1.0067, 1.0068, 1.0069, 1.007, 1.007, 1.0071, 1.0072, 1.0073, 1.0073, 1.0074, 1.0074, 1.0075, 1.0076, 1.0077, 1.0078, 1.0078, 1.0079, 1.008, 1.0081, 1.0082, 1.0082, 1.0083, 1.0084, 1.0085, 1.0086, 1.0086, 1.0087, 1.0088, 1.0089, 1.009, 1.009, 1.0091, 1.0092, 1.0093, 1.0094, 1.0094, 1.0095, 1.0096, 1.0097, 1.0098, 1.0098, 1.0099, 1.01, 1.0101, 1.0102, 1.0102, 1.0103, 1.0104, 1.0105, 1.0106, 1.0106, 1.0107, 1.0108, 1.0109, 1.011, 1.011, 1.0111, 1.0112, 1.0113, 1.0114, 1.0114, 1.0115, 1.0116, 1.0117, 1.0118, 1.0118, 1.0119, 1.012, 1.0121, 1.0122, 1.0122, 1.0123, 1.0124, 1.0125, 1.0126, 1.0126, 1.0127, 1.0127, 1.0128, 1.0129, 1.013, 1.013, 1.0131, 1.0132, 1.0133, 1.0134, 1.0134, 1.0135, 1.0136, 1.0137, 1.0138, 1.0138, 1.0139, 1.014, 1.0141, 1.0142, 1.0142, 1.0143, 1.0144, 1.0145, 1.0146, 1.0146, 1.0147, 1.0148, 1.0149, 1.015, 1.015, 1.0151, 1.0152, 1.0153, 1.0154, 1.0154, 1.0155, 1.0156, 1.0157, 1.0158, 1.0158, 1.0159, 1.016, 1.0161, 1.0162, 1.0162, 1.0163, 1.0164, 1.0165, 1.0166, 1.0166, 1.0167, 1.0168, 1.0169, 1.017, 1.017, 1.0171, 1.0172, 1.0173, 1.0174, 1.0174, 1.0175, 1.0176, 1.0177, 1.0178, 1.0178, 1.0179, 1.018, 1.0181, 1.0182, 1.0182, 1.0183, 1.0184, 1.0185, 1.0186, 1.0186, 1.0187, 1.0188, 1.0189, 1.019, 1.019, 1.0191, 1.0192, 1.0193, 1.0194, 1.0194, 1.0195, 1.0196, 1.0197, 1.0198, 1.0198, 1.0199, 1.02, 1.0201, 1.0202, 1.0202, 1.0203, 1.0204, 1.0205, 1.0206, 1.0206, 1.0207, 1.0208, 1.0209, 1.021, 1.021, 1.0211, 1.0212, 1.0213, 1.0214, 1.0214, 1.0215, 1.0216, 1.0217, 1.0218, 1.0218, 1.0219, 1.022, 1.0221, 1.0222, 1.0222, 1.0223, 1.0224, 1.0225, 1.0226, 1.0226, 1.0227, 1.0228, 1.0229, 1.023, 1.023, 1.0231, 1.0232, 1.0233, 1.0233, 1.0234, 1.0234, 1.0235, 1.0236, 1.0237, 1.0238, 1.0238, 1.0239, 1.024, 1.0241, 1.0242, 1.0242, 1.0243, 1.0244, 1.0245, 1.0246, 1.0246, 1.0247, 1.0248, 1.0249, 1.025, 1.025, 1.0251, 1.0252, 1.0253, 1.0254, 1.0254, 1.0255, 1.0256, 1.0257, 1.0258, 1.0258, 1.0259, 1.026, 1.0261, 1.0262, 1.0262, 1.0263, 1.0264, 1.0265, 1.0266, 1.0266, 1.0267, 1.0268, 1.0269, 1.027, 1.027, 1.0271, 1.0272, 1.0273, 1.0274, 1.0274, 1.0275, 1.0276, 1.0277, 1.0278, 1.0278, 1.0279, 1.028, 1.0281, 1.0282, 1.0282, 1.0283, 1.0284, 1.0285, 1.0286, 1.0286, 1.0287, 1.0287, 1.0288, 1.0289, 1.029, 1.029, 1.0291, 1.0292, 1.0293, 1.0294, 1.0294, 1.0295, 1.0296, 1.0297, 1.0298, 1.0298, 1.0299, 1.03, 1.0301, 1.0302, 1.0302, 1.0303, 1.0304, 1.0305, 1.0306, 1.0306, 1.0307, 1.0308, 1.0309, 1.031, 1.031, 1.0311, 1.0312, 1.0313, 1.0314, 1.0314, 1.0315, 1.0316, 1.0317, 1.0318, 1.0318, 1.0319, 1.032, 1.0321, 1.0322, 1.0322, 1.0323, 1.0324, 1.0325, 1.0326, 1.0326, 1.0327, 1.0328, 1.0329, 1.033, 1.033, 1.0331, 1.0332, 1.0333, 1.0334, 1.0334, 1.0335, 1.0336, 1.0337, 1.0338, 1.0338, 1.0339, 1.034, 1.0341, 1.0342, 1.0342, 1.0343, 1.0344, 1.0345, 1.0346, 1.0346, 1.0347, 1.0348, 1.0349, 1.035, 1.035, 1.0351, 1.0352, 1.0353, 1.0354, 1.0354, 1.0355, 1.0356, 1.0357, 1.0358, 1.0358, 1.0359, 1.036, 1.0361, 1.0362, 1.0362, 1.0363, 1.0364, 1.0365, 1.0366, 1.0366, 1.0367, 1.0368, 1.0369, 1.037, 1.037, 1.0371, 1.0372, 1.0373, 1.0374, 1.0374, 1.0375, 1.0376, 1.0377, 1.0378, 1.0378, 1.0379, 1.038, 1.0381, 1.0382, 1.0382, 1.0383, 1.0384, 1.0385, 1.0386, 1.0386, 1.0387, 1.0388, 1.0389, 1.039, 1.039, 1.0391, 1.0392, 1.0393, 1.0393, 1.0394, 1.0394, 1.0395, 1.0396, 1.0397, 1.0398, 1.0398, 1.0399, 1.04, 1.0401, 1.0402, 1.0402, 1.0403, 1.0404, 1.0405, 1.0406, 1.0406, 1.0407, 1.0408, 1.0409, 1.041, 1.041, 1.0411, 1.0412, 1.0413, 1.0414, 1.0414, 1.0415, 1.0416, 1.0417, 1.0418, 1.0418, 1.0419, 1.042, 1.0421, 1.0422, 1.0422, 1.0423, 1.0424, 1.0425, 1.0426, 1.0426, 1.0427, 1.0428, 1.0429, 1.043, 1.043, 1.0431, 1.0432, 1.0433, 1.0434, 1.0434, 1.0435, 1.0436, 1.0437, 1.0438, 1.0438, 1.0439, 1.044, 1.0441, 1.0442, 1.0442, 1.0443, 1.0444, 1.0445, 1.0446, 1.0446, 1.0447, 1.0447, 1.0448, 1.0449, 1.045, 1.045, 1.0451, 1.0452, 1.0453, 1.0454, 1.0454, 1.0455, 1.0456, 1.0457, 1.0458, 1.0458, 1.0459, 1.046, 1.0461, 1.0462, 1.0462, 1.0463, 1.0464, 1.0465, 1.0466, 1.0466, 1.0467, 1.0468, 1.0469, 1.047, 1.047, 1.0471, 1.0472, 1.0473, 1.0474, 1.0474, 1.0475, 1.0476, 1.0477, 1.0478, 1.0478, 1.0479, 1.048, 1.0481, 1.0482, 1.0482, 1.0483, 1.0484, 1.0485, 1.0486, 1.0486, 1.0487, 1.0488, 1.0489, 1.049, 1.049, 1.0491, 1.0492, 1.0493, 1.0494, 1.0494, 1.0495, 1.0496, 1.0497, 1.0498, 1.0498, 1.0499, 1.05])
trad_y_fit = np.array([-0.011179, -0.011176, -0.011174, -0.011171, -0.011167, -0.011164, -0.01116, -0.011155, -0.011151, -0.011146, -0.011141, -0.011135, -0.01113, -0.011124, -0.011117, -0.011111, -0.011104, -0.011097, -0.011089, -0.011082, -0.011074, -0.011065, -0.011057, -0.011048, -0.011039, -0.011029, -0.01102, -0.01101, -0.010999, -0.010989, -0.010978, -0.010967, -0.010955, -0.010944, -0.010932, -0.010919, -0.010907, -0.010894, -0.010881, -0.010868, -0.010855, -0.010841, -0.010827, -0.010812, -0.010798, -0.010783, -0.010768, -0.010753, -0.010737, -0.010722, -0.010706, -0.01069, -0.010673, -0.010657, -0.01064, -0.010623, -0.010606, -0.010588, -0.010571, -0.010553, -0.010535, -0.010516, -0.010498, -0.010479, -0.010461, -0.010442, -0.010423, -0.01041, -0.010403, -0.010384, -0.010364, -0.010344, -0.010325, -0.010304, -0.010284, -0.010264, -0.010244, -0.010223, -0.010202, -0.010181, -0.01016, -0.010139, -0.010118, -0.010097, -0.010076, -0.010054, -0.010033, -0.010011, -0.0099897, -0.009968, -0.0099463, -0.0099245, -0.0099026, -0.0098808, -0.0098588, -0.0098369, -0.0098149, -0.0097929, -0.0097709, -0.0097489, -0.0097269, -0.0097049, -0.0096829, -0.0096609, -0.0096389, -0.009617, -0.0095951, -0.0095733, -0.0095514, -0.0095297, -0.009508, -0.0094864, -0.0094648, -0.0094433, -0.0094219, -0.0094006, -0.0093794, -0.0093583, -0.0093372, -0.0093163, -0.0092956, -0.0092749, -0.0092544, -0.009234, -0.0092138, -0.0091937, -0.0091738, -0.009154, -0.0091344, -0.009115, -0.0090958, -0.0090768, -0.0090579, -0.0090393, -0.0090208, -0.0090147, -0.0090026, -0.0089846, -0.0089668, -0.0089493, -0.008932, -0.0089149, -0.0088981, -0.0088815, -0.0088652, -0.0088492, -0.0088334, -0.0088179, -0.0088027, -0.0087878, -0.0087732, -0.0087589, -0.0087449, -0.0087312, -0.0087179, -0.0087049, -0.0086921, -0.0086798, -0.0086678, -0.0086561, -0.0086447, -0.0086338, -0.0086232, -0.0086129, -0.0086031, -0.0085936, -0.0085845, -0.0085758, -0.0085675, -0.0085596, -0.008552, -0.0085449, -0.0085382, -0.008532, -0.0085261, -0.0085207, -0.0085157, -0.0085112, -0.008507, -0.0085034, -0.0085002, -0.0084974, -0.0084951, -0.0084932, -0.0084918, -0.0084909, -0.0084905, -0.0084905, -0.008491, -0.008492, -0.0084935, -0.0084955, -0.0084979, -0.0085009, -0.0085043, -0.0085083, -0.0085127, -0.0085177, -0.0085232, -0.0085292, -0.0085357, -0.0085427, -0.0085503, -0.0085584, -0.0085669, -0.0085761, -0.0085857, -0.0085959, -0.0086066, -0.0086179, -0.0086296, -0.008642, -0.0086548, -0.0086682, -0.0086822, -0.0086966, -0.0087117, -0.0087272, -0.0087433, -0.00876, -0.0087772, -0.0087949, -0.0088132, -0.0088321, -0.0088514, -0.0088714, -0.0088919, -0.0089129, -0.0089344, -0.0089566, -0.0089792, -0.0090024, -0.0090262, -0.0090505, -0.0090753, -0.0091007, -0.0091266, -0.009153, -0.00918, -0.0092076, -0.0092356, -0.0092642, -0.0092933, -0.009323, -0.0093531, -0.0093838, -0.0094151, -0.0094468, -0.0094791, -0.0095118, -0.0095451, -0.0095789, -0.0096132, -0.009648, -0.0096833, -0.0097191, -0.0097554, -0.0097922, -0.0098294, -0.0098672, -0.0099054, -0.0099441, -0.0099833, -0.010023, -0.010063, -0.010104, -0.010145, -0.010186, -0.010228, -0.010256, -0.01027, -0.010313, -0.010356, -0.0104, -0.010444, -0.010489, -0.010533, -0.010579, -0.010624, -0.010671, -0.010717, -0.010764, -0.010811, -0.010859, -0.010907, -0.010955, -0.011004, -0.011053, -0.011102, -0.011152, -0.011202, -0.011252, -0.011303, -0.011354, -0.011405, -0.011457, -0.011509, -0.011561, -0.011613, -0.011666, -0.011719, -0.011772, -0.011826, -0.011879, -0.011933, -0.011987, -0.012042, -0.012096, -0.012151, -0.012206, -0.012261, -0.012317, -0.012372, -0.012428, -0.012484, -0.012539, -0.012596, -0.012652, -0.012708, -0.012765, -0.012821, -0.012878, -0.012934, -0.012991, -0.013048, -0.013105, -0.013162, -0.013219, -0.013276, -0.013333, -0.01339, -0.013448, -0.013505, -0.013562, -0.013619, -0.013676, -0.013733, -0.013752, -0.01379, -0.013847, -0.013904, -0.013961, -0.014018, -0.014074, -0.014131, -0.014187, -0.014244, -0.0143, -0.014356, -0.014412, -0.014468, -0.014523, -0.014579, -0.014634, -0.014689, -0.014744, -0.014799, -0.014854, -0.014908, -0.014962, -0.015016, -0.01507, -0.015123, -0.015176, -0.015229, -0.015281, -0.015334, -0.015386, -0.015437, -0.015489, -0.01554, -0.015591, -0.015641, -0.015691, -0.015741, -0.01579, -0.015839, -0.015888, -0.015936, -0.015984, -0.016031, -0.016078, -0.016125, -0.016171, -0.016217, -0.016262, -0.016307, -0.016351, -0.016395, -0.016439, -0.016482, -0.016524, -0.016567, -0.016608, -0.016649, -0.01669, -0.01673, -0.016769, -0.016808, -0.016847, -0.016885, -0.016922, -0.016959, -0.016995, -0.017031, -0.017066, -0.0171, -0.017134, -0.017168, -0.017201, -0.017233, -0.017264, -0.017295, -0.017326, -0.017355, -0.017384, -0.017413, -0.017441, -0.017468, -0.017495, -0.01752, -0.017546, -0.01757, -0.017594, -0.017617, -0.01764, -0.017662, -0.017683, -0.017704, -0.017724, -0.017743, -0.017761, -0.017779, -0.017796, -0.017813, -0.017828, -0.017843, -0.017858, -0.017871, -0.017884, -0.017896, -0.017908, -0.017919, -0.017929, -0.017938, -0.017946, -0.017954, -0.017961, -0.017968, -0.017973, -0.017978, -0.017983, -0.017986, -0.017989, -0.017991, -0.017992, -0.017993, -0.017992, -0.017992, -0.01799, -0.017988, -0.017984, -0.017981, -0.017976, -0.017971, -0.017965, -0.017958, -0.01795, -0.017942, -0.017933, -0.017924, -0.017917, -0.017913, -0.017902, -0.01789, -0.017878, -0.017864, -0.01785, -0.017836, -0.01782, -0.017804, -0.017788, -0.01777, -0.017752, -0.017733, -0.017713, -0.017693, -0.017672, -0.017651, -0.017628, -0.017605, -0.017582, -0.017558, -0.017533, -0.017507, -0.017481, -0.017454, -0.017426, -0.017398, -0.017369, -0.01734, -0.01731, -0.017279, -0.017248, -0.017216, -0.017184, -0.017151, -0.017117, -0.017083, -0.017048, -0.017012, -0.016976, -0.01694, -0.016903, -0.016865, -0.016827, -0.016788, -0.016749, -0.016709, -0.016669, -0.016628, -0.016587, -0.016545, -0.016502, -0.01646, -0.016416, -0.016373, -0.016328, -0.016284, -0.016239, -0.016193, -0.016147, -0.016101, -0.016054, -0.016007, -0.015959, -0.015911, -0.015862, -0.015814, -0.015797, -0.015765, -0.015715, -0.015665, -0.015615, -0.015564, -0.015513, -0.015462, -0.015411, -0.015359, -0.015307, -0.015254, -0.015201, -0.015148, -0.015095, -0.015042, -0.014988, -0.014934, -0.01488, -0.014825, -0.014771, -0.014716, -0.014661, -0.014605, -0.01455, -0.014494, -0.014439, -0.014383, -0.014327, -0.014271, -0.014214, -0.014158, -0.014101, -0.014045, -0.013988, -0.013931, -0.013874, -0.013817, -0.01376, -0.013703, -0.013646, -0.013589, -0.013532, -0.013475, -0.013418, -0.013361, -0.013304, -0.013247, -0.013189, -0.013132, -0.013075, -0.013019, -0.012962, -0.012905, -0.012848, -0.012792, -0.012735, -0.012679, -0.012623, -0.012566, -0.01251, -0.012454, -0.012399, -0.012343, -0.012288, -0.012233, -0.012178, -0.012123, -0.012068, -0.012014, -0.011959, -0.011905, -0.011851, -0.011798, -0.011745, -0.011691, -0.011639, -0.011586, -0.011534, -0.011482, -0.01143, -0.011379, -0.011327, -0.011277, -0.011226, -0.011176, -0.011126, -0.011076, -0.011027, -0.010978, -0.01093, -0.010882, -0.010834, -0.010787, -0.010739, -0.010693, -0.010647, -0.010601, -0.010555, -0.01051, -0.010465, -0.010421, -0.010377, -0.010334, -0.010291, -0.010248, -0.010206, -0.010164, -0.010123, -0.010082, -0.010042, -0.010002, -0.0099629, -0.0099239, -0.0098855, -0.0098475, -0.00981, -0.009773, -0.0097365, -0.0097004, -0.0096649, -0.0096298, -0.0095953, -0.0095613, -0.0095277, -0.0094947, -0.0094622, -0.0094302, -0.0093988, -0.0093678, -0.0093374, -0.0093075, -0.0092781, -0.0092493, -0.0092303, -0.009221, -0.0091932, -0.0091659, -0.0091392, -0.009113, -0.0090874, -0.0090623, -0.0090378, -0.0090138, -0.0089903, -0.0089674, -0.008945, -0.0089232, -0.0089019, -0.0088811, -0.0088609, -0.0088413, -0.0088222, -0.0088036, -0.0087856, -0.0087682, -0.0087513, -0.0087349, -0.0087191, -0.0087038, -0.008689, -0.0086748, -0.0086612, -0.0086481, -0.0086355, -0.0086234, -0.0086119, -0.008601, -0.0085905, -0.0085806, -0.0085713, -0.0085624, -0.0085541, -0.0085463, -0.008539, -0.0085323, -0.008526, -0.0085203, -0.0085151, -0.0085104, -0.0085062, -0.0085025, -0.0084993, -0.0084966, -0.0084944, -0.0084927, -0.0084914, -0.0084907, -0.0084904, -0.0084906, -0.0084913, -0.0084925, -0.0084941, -0.0084962, -0.0084988, -0.0085018, -0.0085052, -0.0085091, -0.0085135, -0.0085183, -0.0085235, -0.0085291, -0.0085311, -0.0085352, -0.0085417, -0.0085486, -0.0085559, -0.0085636, -0.0085717, -0.0085803, -0.0085892, -0.0085985, -0.0086082, -0.0086182, -0.0086286, -0.0086394, -0.0086506, -0.0086621, -0.008674, -0.0086862, -0.0086987, -0.0087116, -0.0087248, -0.0087383, -0.0087522, -0.0087663, -0.0087808, -0.0087955, -0.0088106, -0.0088259, -0.0088416, -0.0088575, -0.0088736, -0.0088901, -0.0089068, -0.0089237, -0.0089409, -0.0089584, -0.008976, -0.0089939, -0.0090121, -0.0090304, -0.0090489, -0.0090677, -0.0090866, -0.0091058, -0.0091251, -0.0091446, -0.0091643, -0.0091841, -0.0092041, -0.0092243, -0.0092446, -0.0092651, -0.0092856, -0.0093064, -0.0093272, -0.0093482, -0.0093692, -0.0093904, -0.0094117, -0.009433, -0.0094545, -0.009476, -0.0094976, -0.0095193, -0.009541, -0.0095628, -0.0095846, -0.0096065, -0.0096284, -0.0096504, -0.0096723, -0.0096943, -0.0097163, -0.0097383, -0.0097603, -0.0097824, -0.0098044, -0.0098263, -0.0098483, -0.0098702, -0.0098921, -0.009914, -0.0099358, -0.0099576, -0.0099793, -0.010001, -0.010023, -0.010044, -0.010066, -0.010087, -0.010108, -0.010129, -0.01015, -0.010171, -0.010192, -0.010213, -0.010234, -0.010254, -0.010275, -0.010295, -0.010315, -0.010335, -0.010355, -0.010374, -0.010394, -0.010413, -0.010433, -0.010452, -0.01047, -0.010489, -0.010508, -0.010526, -0.010544, -0.010562, -0.01058, -0.010597, -0.010615, -0.010632, -0.010649, -0.010665, -0.010682, -0.010698, -0.010714, -0.01073, -0.010746, -0.010761, -0.010776, -0.010791, -0.010806, -0.01082, -0.010834, -0.010848, -0.010862, -0.010875, -0.010884, -0.010888, -0.010901, -0.010914, -0.010926, -0.010938, -0.01095, -0.010961, -0.010973, -0.010983, -0.010994, -0.011005, -0.011015, -0.011025, -0.011034, -0.011044, -0.011053, -0.011061, -0.01107, -0.011078, -0.011086, -0.011093, -0.011101, -0.011108, -0.011114, -0.011121, -0.011127, -0.011133, -0.011138, -0.011144, -0.011149, -0.011153, -0.011158, -0.011162, -0.011165, -0.011169, -0.011172, -0.011175, -0.011178, -0.01118, -0.011182, -0.011184, -0.011185, -0.011186, -0.011187, -0.011188, -0.011188, -0.011188, -0.011188, -0.011188, -0.011187, -0.011186, -0.011184, -0.011183, -0.011181, -0.011179, -0.011176, -0.011174, -0.011171, -0.011167, -0.011164, -0.01116, -0.011156, -0.011152, -0.011147, -0.011143, -0.011137, -0.011132, -0.01113, -0.011127, -0.011121, -0.011115, -0.011109, -0.011102, -0.011096, -0.011089, -0.011081, -0.011074, -0.011067, -0.011059, -0.011051, -0.011042, -0.011034, -0.011025, -0.011017, -0.011008, -0.010998, -0.010989, -0.010979, -0.010969, -0.010959, -0.010949, -0.010939, -0.010928, -0.010918, -0.010907, -0.010896, -0.010885, -0.010874, -0.010862, -0.01085, -0.010839, -0.010827, -0.010815, -0.010803, -0.01079, -0.010778, -0.010766, -0.010753, -0.01074, -0.010727, -0.010714, -0.010701, -0.010688, -0.010675, -0.010662, -0.010648, -0.010635, -0.010621, -0.010608, -0.010594, -0.01058, -0.010566, -0.010553, -0.010539, -0.010525, -0.010511, -0.010497, -0.010482, -0.010468, -0.010454, -0.01044, -0.010426, -0.010412, -0.010397, -0.010383])

##============================ Normalize Data for Comparison ==================

# offset_x = -0.016
# offset_y = -0.001
doub_opt = 0.9899
trad_opt = 1.0063

# Re-center X
doub_x_norm = doub_x - doub_opt

# Normalize Y
doub_y_norm = doub_y-np.min(doub_y) # Shift min to zero
doub_y_norm = doub_y_norm/np.max(doub_y_norm) # Re-normalize amplitude

# Re-center X
trad_x_norm = trad_x - trad_opt

# Normalize Y
trad_y_norm = trad_y-np.min(trad_y) # Shift min to zero
trad_y_norm = trad_y_norm/np.max(trad_y_norm) # Re-normalize amplitude

##============================== Plot Data =========================

color_trad = (0.3, 0.3, 0.3)
color_doub = (0, 119/255, 179/255) # From TQE template section header color

# Prepare figure 1
fig1 = plt.figure(1)
gs1 = fig1.add_gridspec(1, 1)
ax1a = fig1.add_subplot(gs1[0, 0])

ax1a.plot(doub_x_norm, doub_y_norm, linestyle=':', marker='o', color=color_doub, label="Frequency-Doubler Drive", markersize=7)
ax1a.plot(trad_x_norm, trad_y_norm, linestyle='--', marker='+', color=color_trad, label="Traditional Drive", markersize=10, markeredgewidth=2)

ax1a.grid(True)
ax1a.set_xlabel("Amplitude Coefficient, Normalized to Optimal")
ax1a.set_ylabel(f"State Readout Voltage\nAveraged across Sequence Length and Normalized")
ax1a.set_title("Amplitude Coefficient Optimization")
ax1a.legend()

if args.pub:
	mpl.rcParams['font.family'] = 'sans-serif'
	mpl.rcParams['font.sans-serif'] = ['Arial']

if args.save:
	fig1.savefig(os.path.join("figures", "AP4_fig1.pdf"))

mplcursors.cursor(multiple=True)

plt.show()